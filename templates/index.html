<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸŒ± æˆé•·ãƒ­ã‚°ã‚¢ãƒ—ãƒª</title>

    <!-- CSS -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>

<body>
    <div class="container">
        
        <p>ã“ã‚“ã«ã¡ã¯ã€{{ username }}ã•ã‚“ï¼ <a href="{{ url_for('logout') }}">ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ</a></p>
        <h1>ğŸŒ± æˆé•·ãƒ­ã‚°ã‚¢ãƒ—ãƒª</h1>

        <!-- å…¥åŠ›ãƒ•ã‚©ãƒ¼ãƒ  -->
        <div class="card">
            <h2>å­¦ç¿’ã‚’è¿½åŠ </h2>

            <form method="POST">
                <select name="category" required>
                    {% for category in categories %}
                        <option value="{{ category }}">{{ category }}</option>
                    {% endfor %}
                </select>

                <input type="number" name="study_time" placeholder="åˆ†" required>

                <button type="submit">è¿½åŠ </button>
            </form>
        </div>




        <!-- KPIã‚¨ãƒªã‚¢ -->
    <div class="card">
        <div class="kpi-wrapper">
            <div class="kpi">
                <h2>ä»Šæ—¥ã®åˆè¨ˆ</h2>
                <p>{{ today_total_str }} </p>
            </div>

            <div class="kpi">
                <h2>ä»Šé€±ã®åˆè¨ˆ</h2>
                <p>{{ week_total_str }} </p>
            </div>
        </div>
    </div>

        <!-- ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆè¨ˆ -->
        <div class="card">
            <h2>ã‚«ãƒ†ã‚´ãƒªåˆ¥åˆè¨ˆ</h2>
            <ul>
                {% for category, total in category_totals %}
                    <li>{{ category }} : {{ total }} åˆ†</li>
                {% endfor %}
            </ul>
        </div>

        <!-- ã‚°ãƒ©ãƒ• -->
        <div class="card">
            <h2>ã‚«ãƒ†ã‚´ãƒªåˆ¥ã‚°ãƒ©ãƒ•</h2>
            <canvas id="myChart"></canvas>
        </div>


        <!-- ãƒ‡ãƒ¼ã‚¿ä¸€è¦§ -->
        <div class="card">
            <h2>è¨˜éŒ²ä¸€è¦§</h2>

            <ul>
                {% for log in logs %}
                    <li>
                        {{ log[1] }} - {{ log[2] }} åˆ†
                        <a href="/delete/{{ log[0] }}" class="delete-btn">
                            <svg xmlns="http://www.w3.org/2000/svg" 
                                width="18" 
                                height="18" 
                                fill="none" 
                                viewBox="0 0 24 24" 
                                stroke="currentColor" 
                                stroke-width="2">
                                <path stroke-linecap="round" stroke-linejoin="round" 
                                    d="M6 7h12M9 7V4h6v3m-7 0v13m4-13v13m4-13v13M5 7h14l-1 14H6L5 7z"/>
                            </svg>
                        </a>

                    </li>
                {% endfor %}
            </ul>
        </div>

    </div>

    <!-- ã‚°ãƒ©ãƒ•æç”»ã‚¹ã‚¯ãƒªãƒ—ãƒˆ -->
    <script>
        const ctx = document.getElementById('myChart');

        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: {{ labels | tojson }},
                datasets: [{
                    label: 'åˆè¨ˆå‹‰å¼·æ™‚é–“ï¼ˆåˆ†ï¼‰',
                    data: {{ values | tojson }},
                    borderWidth: 1
                }]
            },
            options: {
                plugins: {
                    legend: {
                        display: false
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true
                    }
                }
            }
        });
    </script>



</body>
</html>
